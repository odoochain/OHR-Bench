[
    {
        "page_idx": 0,
        "text": "of approximating it with a positive definite matrix may be problematic. BFGS updating requires that $S_{k}$ and $y_{k}$ satisfy the curvature condition $s_{k}^{T}y_{k}>0$ , which may not hold when $S_{k}$ and $y_{k}$ are defined by (18.13), even when the iterates are close to the solution. \nTo overcome this difficulty, we could skip the BFGS update if the condition \n$$\ns_{k}^{T}y_{k}\\ge\\theta s_{k}^{T}B_{k}s_{k}\n$$\nis not satisfied, where $\\theta$ is apositive parameter $(10^{-2},\\mathrm{say})$ . This strategy may, on occasion, yield poor performance or even failure, so it cannot be regarded as adequate for generalpurposealgorithms. \nA more effective modification ensures that the update is always well defined by modifying the definition of $y_{k}$ \nProcedure 18.2 (Damped BFGS Updating). \nGiven: symmetric and positive definite matrix $B_{k}$ Define $S_{k}$ and $y_{k}$ as in (18.13) and set \n$$\nr_{k}=\\theta_{k}y_{k}+\\left(1-\\theta_{k}\\right)B_{k}s_{k},\n$$\nwhere the scalar $\\theta_{k}$ is defined as \n$$\n\\theta_{k}=\\left\\{\\begin{array}{l l}{1}&{\\mathrm{if}s_{k}^{T}y_{k}\\geq0.2s_{k}^{T}B_{k}s_{k},}\\ {(0.8s_{k}^{T}B_{k}s_{k})/(s_{k}^{T}B_{k}s_{k}-s_{k}^{T}y_{k})}&{\\mathrm{if}s_{k}^{T}y_{k}<0.2s_{k}^{T}B_{k}s_{k};}\\end{array}\\right.\n$$\nUpdate $B_{k}$ as follows: \n$$\nB_{k+1}=B_{k}-{\\frac{B_{k}s_{k}s_{k}^{T}B_{k}}{s_{k}^{T}B_{k}s_{k}}}+{\\frac{r_{k}r_{k}^{T}}{s_{k}^{T}r_{k}}}.\n$$\nThe formula (18.16) is simply the standard BFGS update formula, with $y_{k}$ replaced by $r_{k}$ . It guarantees that $B_{k+1}$ is positive definite,since it is easy to show that when $\\theta_{k}\\neq1$ wehave \n$$\ns_{k}^{T}r_{k}=0.2s_{k}^{T}B_{k}s_{k}>0.\n$$\nTo gain more insight into this strategy, note that the choice $\\theta_{k}=0$ gives $B_{k+1}=B_{k}$ , while $\\theta_{k}=1$ gives the (possibly indefinite) matrix produced by the unmodified BFGS update. A value $\\theta_{k}\\in(0,1)$ thus produces a matrix that interpolates the current approximation $B_{k}$ and the one produced by the unmodified BFGS formula.The choice of $\\theta_{k}$ ensures that the new approximation stays close enough to the current approximation $B_{k}$ to ensure positive definiteness."
    }
]